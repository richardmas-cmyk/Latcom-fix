================================================================================
TELEFONICA vs LATCOM RECONCILIATION ANALYSIS
================================================================================
Start Time: 2025-10-11 16:35:54
Output File: /Users/richardmas/latcom-fix/reconciliation_reports/TELEFONICA_RECONCILIATION_DETAILED_20251011_163554.xlsx
================================================================================

[1/7] Loading Telefónica's disputed transactions file...
  ✓ Loaded 86,958 transactions from Telefónica
  Columns: ['FECHA', 'NUM_TELEFONO', 'COD_BONO', 'SEC_ACTUACION', 'ImpUSD', 'CANTIDAD_ADI', 'CANTIDAD_MITOPUP', 'DIF']
  Date range: 2023-09-01 00:00:00 to 2024-12-31 00:00:00
  Unique phone numbers: 44,707

[2/7] Loading and consolidating Latcom CDR files...
  ✓ TOPUP  OCTUBRE-2023.xlsx: 10,675 records
  ✓ TOPUP  NOVIEMBRE-2023.xlsx: 12,153 records
  ✓ TOPUP SEPTIEMBRE-2023.xlsx: 6,526 records
  ✓ TOPUP DICIEMBRE-2023.xlsx: 12,362 records
  ✓ TOPUP  MAYO-2024.xlsx: 7,323 records
  ✓ TOPUP FEBRERO-2024.xlsx: 9,593 records
  ✓ TOPUP ENERO-2024.xlsx: 11,344 records
  ✓ TOPUP ABRIL-2024.xlsx: 8,331 records
  ✓ TOPUP OCTUBRE-2024.xlsx: 15,048 records
  ✓ TOPUP  AGOSTO 2024.xlsx: 8,855 records
  ✓ TOPUP JUNIO-2024.xlsx: 6,876 records
  ✓ TOPUP DICIEMBRE 2024.xlsx: 9,321 records
  ✓ TOPUP MARZO-2024.xlsx: 9,310 records
  ✓ TOPUP  JULIO-2024.xlsx: 6,368 records
  ✓ TOPUP NOVIEMBRE 2024.xlsx: 10,236 records
  ✓ TOPUP  SEPTIEMBRE 2024.xlsx: 25,696 records
  ✓ BUNDLES NOVIEMBRE 2023.xlsx: 3,694 records
  ✓ BUNDLES DICIEMBRE 2023.xlsx: 3,816 records
  ✓ BUNDLES SEPTIEMBRE 2023.xlsx: 3,868 records
  ✓ BUNDLES OCTUBRE 20231.xlsx: 3,730 records
  ✓ BUNDLES AGOSTO 2024.xlsx: 4,725 records
  ✓ BUNDLES FEBRERO 2024.xlsx: 3,735 records
  ✓ BUNDLES DICIEMBRE 2024.xlsx: 4,878 records
  ✓ BUNDLES MARZO 2024.xlsx: 4,178 records
  ✓ BUNDLES NOVIEMBRE 2024.xlsx: 4,807 records
  ✓ BUNDLES JUNIO 2024.xlsx: 5,007 records
  ✓ BUNDLES ABRIL 2024.xlsx: 4,227 records
  ✓ BUNDLES ENERO 2024.xlsx: 3,782 records
  ✓ BUNDLES OCTUBRE 2024.xlsx: 5,120 records
  ✓ BUNDLES SEPTIEMBRE 2024.xlsx: 5,041 records
  ✓ BUNDLES MAYO 2024.xlsx: 5,044 records
  ✓ BUNDLES JULIO 2024.xlsx: 5,499 records

  ✓ Total Latcom records loaded: 241,168
  Columns in Latcom data: ['TransactionID', 'TransactionDate', 'TransactionTime', 'TargetMSISDN', 'Product', 'ProductType', 'TransactionAmountUSD', 'SOURCE_FILE', 'TRANSACTION_TYPE', 'Product Sagar', 'Product ', 'Date', 'Time', 'RechargeCurrency', 'Product MobiFin', 'Product MoviStar']

[3/7] Identifying and normalizing Latcom data fields...
  Phone columns found: ['TargetMSISDN']
  Date columns found: ['TransactionDate', 'TransactionTime', 'Date', 'Time']
  Status columns found: []
  Amount columns found: ['TransactionAmountUSD']
  Transaction ID columns found: ['TransactionID', 'TransactionDate', 'TransactionTime', 'TransactionAmountUSD', 'TRANSACTION_TYPE']
  Duration columns found: ['TransactionTime', 'Time']
  ✗ WARNING: No status column found in Latcom data!
  ✓ Normalized 241,168 Latcom records
  Date range: 2023-09-01 00:00:00 to 2024-10-31 00:00:00
  Unique phone numbers: 107,350
  Status values: {'UNKNOWN': 241168}

[4/7] Creating product code mapping...
  ✓ Product mapping created
  Telefónica products: {'BFRIQUIN': 25618, 'BFRECINT': 17485, 'BFRISEM': 15266, 'BFRIMEN': 8522, 'BFSPRINT': 7437, 'PQRI412D': 7158, 'PQRI3G9D': 2733, 'PQRI2G7D': 1514, 'PQRI1G4D': 662, 'PQRI6M2D': 563}

[5/7] Matching transactions between Telefónica and Latcom...
  Matching by phone + product + date window (±7 days)...
    Latcom BUNDLES: 71,151
    Latcom TOPUP: 170,017
    Telefónica BUNDLES to match: 86,958
    Telefónica BUNDLES (clean): 86,296
    Latcom BUNDLES (clean): 61,466
      Progress: 0 / 86,296 (0.0%) - Matches: 0
      Progress: 4,314 / 86,296 (5.0%) - Matches: 0
      Progress: 8,628 / 86,296 (10.0%) - Matches: 0
      Progress: 12,942 / 86,296 (15.0%) - Matches: 0
      Progress: 17,256 / 86,296 (20.0%) - Matches: 0
      Progress: 21,570 / 86,296 (25.0%) - Matches: 0
      Progress: 25,884 / 86,296 (30.0%) - Matches: 0
      Progress: 30,198 / 86,296 (35.0%) - Matches: 0
      Progress: 34,512 / 86,296 (40.0%) - Matches: 0
      Progress: 38,826 / 86,296 (45.0%) - Matches: 0
      Progress: 43,140 / 86,296 (50.0%) - Matches: 0
      Progress: 47,454 / 86,296 (55.0%) - Matches: 0
      Progress: 51,768 / 86,296 (60.0%) - Matches: 0
      Progress: 56,082 / 86,296 (65.0%) - Matches: 0
      Progress: 60,396 / 86,296 (70.0%) - Matches: 0
      Progress: 64,710 / 86,296 (75.0%) - Matches: 0
      Progress: 69,024 / 86,296 (80.0%) - Matches: 0
      Progress: 73,338 / 86,296 (85.0%) - Matches: 0
      Progress: 77,652 / 86,296 (90.0%) - Matches: 0
      Progress: 81,966 / 86,296 (95.0%) - Matches: 0
      Progress: 86,280 / 86,296 (100.0%) - Matches: 0
      Progress: 86,296 / 86,296 (100.0%) - Matches: 0
    ✓ Matched 0 BUNDLES transactions
    Note: TOPUP matching not implemented (no product codes in Telefónica data)

  ✓ Total matches found: 0
  Telefónica records matched: 0 / 86,958 (0.0%)
  Latcom records matched: 0 / 241,168 (0.0%)

[6/7] Categorizing transactions...
  Category A (Matched - WE OWE): 0 transactions
  Category B (Failed): N/A (no failed transactions in Latcom CDR)
  Category C (Telefónica Only - NOT IN OUR LOGS): 86,958 transactions
  Category D (Latcom Only - NOT IN THEIR CLAIM): 241,168 transactions

[7/7] Calculating summary statistics...
  Calculating month-by-month breakdown...

[8/8] Generating Excel report...
  ✓ Excel report generated successfully: /Users/richardmas/latcom-fix/reconciliation_reports/TELEFONICA_RECONCILIATION_DETAILED_20251011_163554.xlsx

================================================================================
RECONCILIATION ANALYSIS COMPLETE
================================================================================

Output File: /Users/richardmas/latcom-fix/reconciliation_reports/TELEFONICA_RECONCILIATION_DETAILED_20251011_163554.xlsx

SUMMARY STATISTICS:
--------------------------------------------------------------------------------
  Total Telefónica Transactions: 86958
  Total Latcom Transactions: 241168
  Total Matches Found: 0
  Match Rate (%): 0.00%
  Category A - Matched (WE OWE): 0
  Category A - Amount USD: 0
  Category B - Failed (N/A): Not applicable - no failed status in Latcom CDR
  Category C - In Telefónica Only (NOT IN OUR LOGS): 86958
  Category C - Amount USD: 1007493
  Category D - In Latcom Only (NOT IN THEIR CLAIM): 241168

================================================================================
DATA QUALITY ISSUES:
--------------------------------------------------------------------------------
  Latcom records without dates: 29243
  Products with no mapping: 1

================================================================================
MATCHING METHODOLOGY:
--------------------------------------------------------------------------------
  1. Transaction ID matching (most specific)
  2. Phone number + Date matching (fallback)
  3. Status categorization: SUCCESS / FAILED / UNKNOWN
  4. Duration analysis for failed transactions (>7 seconds threshold)

================================================================================
CRITICAL FINDINGS:
--------------------------------------------------------------------------------
  WE OWE (Category A - Matched): 0 transactions - $0.00 USD
  NOT IN OUR LOGS (Category C): 86,958 transactions - $1,007,493.00 USD
  NOT IN THEIR CLAIM (Category D): 241,168 transactions

  TOTAL TELEFONICA CLAIM: $1,007,493.00 USD
  AMOUNT WE CAN CONFIRM: $0.00 USD (0.0%)
  AMOUNT NOT IN OUR LOGS: $1,007,493.00 USD (100.0%)

================================================================================
End Time: 2025-10-11 16:41:06
================================================================================
