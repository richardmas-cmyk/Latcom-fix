# Relier Billing System - Admin Access & Credentials

**Last Updated:** October 1, 2025

---

## üîê Admin Access

### Admin Panel
- **URL:** https://latcom-fix-production.up.railway.app/admin
- **Admin Key:** `[SET IN RAILWAY: ADMIN_KEY variable]`
- **Features:**
  - Manage customer credits (add/subtract balance)
  - View all customers and their balances
  - Filter and search transactions
  - Export transactions to CSV
  - Real-time statistics

### Customer Dashboard
- **URL:** https://latcom-fix-production.up.railway.app/dashboard
- **Access:** No password required (customer-facing)
- **Shows:** Balance, transaction history, auto-refreshes every 10 seconds

### Queue Monitor
- **URL:** https://latcom-fix-production.up.railway.app/queue
- **Access:** No password required
- **Shows:** Queue statistics (when Redis is enabled)
- **Status:** Currently disabled (Redis not connected)

---

## üîë Customer API Credentials

### EnviaDespensa (Primary Customer)

**API Endpoint (Sync):**
```
POST https://latcom-fix-production.up.railway.app/api/enviadespensa/topup
```

**Headers:**
```
Content-Type: application/json
x-api-key: enviadespensa_prod_2025
x-customer-id: ENVIADESPENSA_001
```

**Request Body:**
```json
{
  "phone": "5615622314",
  "amount": 20,
  "reference": "ORDER_123"
}
```

**Response:**
```json
{
  "success": true,
  "transaction": {
    "id": "RLR1759323408154",
    "status": "SUCCESS",
    "amount": 20,
    "phone": "5615622314",
    "operatorTransactionId": "LT12215941",
    "processedAt": "2025-10-01T12:56:54.840Z",
    "currency": "MXN"
  },
  "message": "Top-up processed successfully",
  "remaining_balance": 9749
}
```

---

## üóÑÔ∏è Railway Environment Variables

### Required Variables (Currently Set):

```bash
# Database
DATABASE_URL=postgres://...
DATABASE_PUBLIC_URL=postgres://ballast.proxy.rlwy.net:53798/...

# Latcom Provider API (Backend)
LATCOM_DIST_API=https://lattest.mitopup.com
LATCOM_USERNAME=enviadespensa
LATCOM_PASSWORD=ENV!d32025#
LATCOM_USER_UID=20060916
LATCOM_API_KEY=38aa13413d1431fba1824f2633c2b7d67f5fffcb91b043629a0d1fe09df2fb8d

# Admin Access
ADMIN_KEY=[YOU NEED TO SET THIS]

# PostgreSQL (Auto-generated by Railway)
PGDATABASE=railway
PGHOST=ballast.proxy.rlwy.net
PGPASSWORD=***
PGPORT=53798
PGUSER=postgres

# Railway System Variables (Auto-generated)
RAILWAY_ENVIRONMENT=production
RAILWAY_PROJECT_NAME=latcom-fix
RAILWAY_SERVICE_NAME=Latcom-fix
```

### Optional Variables (For Future Scaling):

```bash
# Redis (Enable when ready for high volume)
REDIS_URL=[Currently disabled - add Redis service URL when needed]
```

---

## üìä Current System Status

### Database
- **Type:** PostgreSQL (Railway)
- **Status:** ‚úÖ Connected
- **Connection Pool:** 20 connections (max)
- **Host:** ballast.proxy.rlwy.net:53798

### Customer Accounts

| Customer ID | Company | Balance | Credit Limit | Status |
|-------------|---------|---------|--------------|--------|
| ENVIADESPENSA_001 | EnviaDespensa | $9,749 MXN | $10,000 MXN | ‚úÖ Active |

### Provider Integration
- **Provider:** Latcom (Backend only - not customer-facing)
- **Status:** ‚úÖ Connected
- **Product:** TFE_MXN_20_TO_2000
- **Range:** 20-2000 MXN (whole numbers only)
- **Operator:** TELEFONICA (Mexico)

---

## üîß System Capabilities

### Current Mode: PRODUCTION (Sync)
- **Max Throughput:** 10-20 transactions/minute
- **Daily Capacity:** ~14,000 transactions
- **Response Time:** 6-7 seconds per transaction
- **Suitable For:** Testing and initial rollout

### Future Mode: PRODUCTION (Async with Redis)
- **Max Throughput:** 30-60 transactions/minute
- **Daily Capacity:** 40,000-80,000 transactions
- **Response Time:** <100ms (queued processing)
- **Requires:** Redis service enabled

---

## üìñ Documentation Files

All documentation is in: `/Users/richardmas/latcom-fix/`

1. **SETUP_GUIDE.md**
   - Complete Railway setup instructions
   - Redis installation guide
   - Horizontal scaling steps
   - Migration plan

2. **QUICK_REFERENCE.md**
   - API endpoint reference
   - Quick test commands
   - Troubleshooting guide
   - Health check commands

3. **SCALABILITY_REPORT.md**
   - System capacity analysis
   - Cost breakdown
   - Performance metrics
   - Upgrade recommendations

4. **ADMIN_ACCESS.md** (this file)
   - All credentials and access info
   - Environment variables
   - Customer API details

---

## üöÄ Quick Test Commands

### Health Check
```bash
curl https://latcom-fix-production.up.railway.app/health
```

### Check Balance
```bash
curl https://latcom-fix-production.up.railway.app/api/balance \
  -H "x-api-key: enviadespensa_prod_2025" \
  -H "x-customer-id: ENVIADESPENSA_001"
```

### Test Topup
```bash
curl -X POST https://latcom-fix-production.up.railway.app/api/enviadespensa/topup \
  -H "Content-Type: application/json" \
  -H "x-api-key: enviadespensa_prod_2025" \
  -H "x-customer-id: ENVIADESPENSA_001" \
  -d '{"phone": "5615622314", "amount": 20, "reference": "TEST"}'
```

---

## üîí Security Notes

### Protect These Credentials:
1. **ADMIN_KEY** - Full admin access to billing system
2. **LATCOM_PASSWORD** - Provider API access
3. **LATCOM_API_KEY** - Provider authentication key
4. **Database credentials** - Direct database access

### Share with Customers:
1. **x-api-key** - Customer API authentication
2. **x-customer-id** - Customer identifier
3. **API endpoint URL** - Public endpoint
4. **Dashboard URL** - Public dashboard (no sensitive data shown)

### Never Share:
- Railway login credentials
- Database passwords
- Admin key
- Latcom provider credentials

---

## üìû Support & Maintenance

### Add Credit to Customer
1. Visit: https://latcom-fix-production.up.railway.app/admin
2. Enter admin key
3. Select customer
4. Enter amount (positive to add, negative to subtract)
5. Click "Update Balance"

### View Transactions
1. Visit admin panel
2. Filter by customer, date, or status
3. Export to CSV if needed

### Monitor System
- **Health:** https://latcom-fix-production.up.railway.app/health
- **Queue Stats:** https://latcom-fix-production.up.railway.app/api/queue/stats
- **Railway Logs:** Railway Dashboard ‚Üí Latcom-fix ‚Üí Logs

---

## üéØ Next Steps (When Volume Increases)

1. **Enable Redis**
   - Add Redis service to Railway
   - Set REDIS_URL variable
   - Enables async processing + caching

2. **Scale Horizontally**
   - Railway ‚Üí Settings ‚Üí Replicas = 2-3
   - Free on Pro plan
   - 2-3x capacity increase

3. **Add More Customers**
   - Use admin panel or database
   - Each gets unique customer_id and api_key
   - Independent credit limits

---

**System is LIVE and ready for EnviaDespensa to test!** üöÄ

**Brand:** Relier (customer-facing)
**Provider:** Latcom (backend only)
**Status:** Production Ready ‚úÖ
